–ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è NumPy —ñ PyTorch –ø—Ä–æ—Å—Ç–∏–º–∏ —Å–ª–æ–≤–∞–º–∏ üíõ

üß© 1. –©–æ —Ü–µ —Ç–∞–∫–µ?

NumPy

–ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ –º–∞—Å–∏–≤–∞–º–∏ —Ç–∞ –º–∞—Ç—Ä–∏—Ü—è–º–∏ –≤ Python.

–û—Å–Ω–æ–≤–Ω–∏–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –Ω–∞—É–∫–æ–≤–∏—Ö –æ–±—á–∏—Å–ª–µ–Ω—å.

–ü—Ä–∞—Ü—é—î —Ç—ñ–ª—å–∫–∏ –Ω–∞ CPU.

PyTorch

–§—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è –Ω–µ–π—Ä–æ–Ω–Ω–∏—Ö –º–µ—Ä–µ–∂ —ñ deep learning.

–£–º—ñ—î –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ —Ç–µ–Ω–∑–æ—Ä–∞–º–∏ (—è–∫ –º–∞—Å–∏–≤–∏ –≤ NumPy) + –∞–≤—Ç–æ–æ–±—á–∏—Å–ª–µ–Ω–Ω—è –≥—Ä–∞–¥—ñ—î–Ω—Ç—ñ–≤.

–ú–æ–∂–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –Ω–∞ CPU —ñ GPU (–∞–ª–µ –≤ —Ç–µ–±–µ ‚Äî —Ç—ñ–ª—å–∫–∏ CPU, —ñ —Ü–µ –æ–∫).

üìê 2. –ú–∞—Å–∏–≤–∏ vs —Ç–µ–Ω–∑–æ—Ä–∏

–í NumPy: numpy.array

–í PyTorch: torch.tensor

–í–æ–Ω–∏ –¥—É–∂–µ —Å—Ö–æ–∂—ñ:

import numpy as np
import torch

a = np.array([1, 2, 3])
b = torch.tensor([1, 2, 3])


–Ü —Ç–∞–º, —ñ —Ç–∞–º ‚Äî –≤–µ–∫—Ç–æ—Ä –∑ —Ç—Ä—å–æ—Ö —á–∏—Å–µ–ª.

–†—ñ–∑–Ω–∏—Ü—è:
‚û° NumPy ‚Äî –ø—Ä–æ—Å—Ç–æ –º–∞—Å–∏–≤
‚û° PyTorch tensor ‚Äî –º–∞—Å–∏–≤ + –∑–Ω–∞—î, –¥–µ –≤—ñ–Ω –ª–µ–∂–∏—Ç—å (CPU/GPU) + –º–æ–∂–µ —Ä–∞—Ö—É–≤–∞—Ç–∏ –≥—Ä–∞–¥—ñ—î–Ω—Ç–∏

‚öôÔ∏è 3. –ì–æ–ª–æ–≤–Ω–∞ —Ñ—ñ—à–∫–∞ PyTorch ‚Äî autograd

–î–ª—è –Ω–µ–π—Ä–æ–Ω–Ω–∏—Ö –º–µ—Ä–µ–∂ —Ç—Ä–µ–±–∞ —Ä–∞—Ö—É–≤–∞—Ç–∏ –≥—Ä–∞–¥—ñ—î–Ω—Ç–∏ (–ø–æ—Ö—ñ–¥–Ω—ñ) –¥–ª—è –Ω–∞–≤—á–∞–Ω–Ω—è.

NumPy:

—Å–∞–º –≥—Ä–∞–¥—ñ—î–Ω—Ç–∏ –Ω–µ —Ä–∞—Ö—É—î

–ø–æ—Ç—Ä—ñ–±–Ω–æ –≤—Å–µ –≤–∏–≤–æ–¥–∏—Ç–∏ —Ä—É–∫–∞–º–∏, –ø–∏—Å–∞—Ç–∏ —Ñ–æ—Ä–º—É–ª–∏, –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –≤–∞–≥

PyTorch:

–º–∞—î autograd

—Å–∞–º –æ–±—á–∏—Å–ª—é—î –≥—Ä–∞–¥—ñ—î–Ω—Ç–∏ –¥–ª—è –±—É–¥—å-—è–∫–æ—ó –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ –æ–ø–µ—Ä–∞—Ü—ñ–π

x = torch.tensor(2.0, requires_grad=True)
y = x**2 + 3*x
y.backward()
print(x.grad)  # –≥—Ä–∞–¥—ñ—î–Ω—Ç dy/dx


–£ NumPy —Ç–∞–∫ –Ω–µ –≤–∏–π–¥–µ ‚Äî —Ç—Ä–µ–±–∞ —Ä–æ–±–∏—Ç–∏ –≤—Å–µ –≤—Ä—É—á–Ω—É.

üöÄ 4. GPU (–≤ —Ç–µ–æ—Ä—ñ—ó)

NumPy: –ø—Ä–∞—Ü—é—î —Ç—ñ–ª—å–∫–∏ –Ω–∞ CPU

PyTorch: –º–æ–∂–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –Ω–∞ GPU (—è–∫—â–æ –≤—ñ–Ω —î)

x = torch.tensor([1., 2.])
# x = x.to("cuda")  # –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –Ω–∞ GPU (—É —Ç–µ–±–µ —Ü–µ –Ω–µ –ø—Ä–∞—Ü—é—î, –±–æ –Ω–µ–º–∞ GPU)


–£ —Ç–µ–±–µ –º–∏ –ø—Ä–æ—Å—Ç–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ CPU, –∞–ª–µ –∫–æ–¥ –≤—Å–µ –æ–¥–Ω–æ PyTorch-–æ–≤–∏–π.

üß† 5. DL / –Ω–µ–π—Ä–æ–Ω–Ω—ñ –º–µ—Ä–µ–∂—ñ

NumPy
–ú–æ–∂–Ω–∞ –Ω–∞–ø–∏—Å–∞—Ç–∏ –Ω–µ–π—Ä–æ–Ω–∫—É –Ω–∞ NumPy, –∞–ª–µ:

—Ç—Ä–µ–±–∞ —Å–∞–º–∏–º –ø–∏—Å–∞—Ç–∏ forward

—Å–∞–º–∏–º –ø–∏—Å–∞—Ç–∏ backward

—Å–∞–º–∏–º –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏ –≤–∞–≥–∏

–≤—Å–µ –¥–æ–≤–≥–æ –π –Ω–µ–∑—Ä—É—á–Ω–æ

PyTorch
–î–ª—è –Ω–µ–π—Ä–æ–Ω–æ–∫ –∑—Ä–æ–±–ª–µ–Ω–æ –í–°–ï:

nn.Linear, nn.ReLU, nn.Sigmoid, nn.Sequential

optim.SGD, optim.Adam

autograd

GPU –ø—ñ–¥—Ç—Ä–∏–º–∫–∞

–∑—Ä—É—á–Ω–µ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –º–æ–¥–µ–ª–µ–π

–¢–æ–º—É —Ç–∏ –π –ø–∏—à–µ—à XOR –Ω–∞ PyTorch, –∞ –Ω–µ –Ω–∞ NumPy.

üìö 6. –î–µ —è–∫–∏–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –∫—Ä–∞—â–µ?

NumPy ‚Äî –∫—Ä–∞—â–µ –∫–æ–ª–∏:

–ø—Ä–æ—Å—Ç–æ —Ç—Ä–µ–±–∞ –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ / –∞–ª–≥–µ–±—Ä–∞

–æ–±—Ä–æ–±–∫–∞ —Ç–∞–±–ª–∏—á–Ω–∏—Ö —á–∏ —á–∏—Å–ª–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö

—Ç–æ–±—ñ –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω—ñ –≥—Ä–∞–¥—ñ—î–Ω—Ç–∏ —Ç–∞ –Ω–µ–π—Ä–æ–Ω–Ω—ñ –º–µ—Ä–µ–∂—ñ

PyTorch ‚Äî –∫—Ä–∞—â–µ –∫–æ–ª–∏:

—Ç–∏ –≤—á–∏—à—Å—è –Ω–µ–π—Ä–æ–Ω–Ω–∏–º –º–µ—Ä–µ–∂–∞–º

—Ç–∏ —Ö–æ—á–µ—à —Ç—Ä–µ–Ω—É–≤–∞—Ç–∏ –º–æ–¥–µ–ª—ñ, –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ –∫—Ä—É—Ç–∏—Ç–∏ –º–∞—Ç—Ä–∏—Ü—ñ

—Ç—Ä–µ–±–∞ –∞–≤—Çograd, loss-—Ñ—É–Ω–∫—Ü—ñ—ó, –æ–ø—Ç–∏–º—ñ–∑–∞—Ç–æ—Ä–∏